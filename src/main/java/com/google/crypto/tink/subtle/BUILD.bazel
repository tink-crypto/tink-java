load("@build_bazel_rules_android//android:rules.bzl", "android_library")

licenses(["notice"])

package(default_visibility = ["//visibility:public"])

java_library(
    name = "prf_aes_cmac",
    srcs = ["PrfAesCmac.java"],
    deps = [
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters",
        "//src/main/java/com/google/crypto/tink/prf:prf_set",
        "//src/main/java/com/google/crypto/tink/prf/internal:prf_aes_cmac",
        "//src/main/java/com/google/crypto/tink/prf/internal:prf_aes_cmac_conscrypt",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "aes_ctr_hmac_streaming",
    srcs = ["AesCtrHmacStreaming.java"],
    deps = [
        ":bytes",
        ":hkdf",
        ":nonce_based_streaming_aead_cluster",
        ":random",
        ":stream_segment_decrypter",
        ":stream_segment_encrypter",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:streaming_aead",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_ctr_hmac_streaming_key",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_ctr_hmac_streaming_parameters",
    ],
)

java_library(
    name = "cha_cha20_poly1305",
    srcs = ["ChaCha20Poly1305.java"],
    deps = [
        ":bytes",
        ":cha_cha20",
        ":random",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/aead:cha_cha20_poly1305_key",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_cha_cha20_poly1305",
        "//src/main/java/com/google/crypto/tink/aead/internal:poly1305",
        "//src/main/java/com/google/crypto/tink/internal:util",
    ],
)

java_library(
    name = "stream_segment_decrypter",
    srcs = ["StreamSegmentDecrypter.java"],
)

java_library(
    name = "aes_ctr_jce_cipher",
    srcs = ["AesCtrJceCipher.java"],
    deps = [
        ":ind_cpa_cipher",
        ":random",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
    ],
)

java_library(
    name = "x25519",
    srcs = ["X25519.java"],
    deps = [
        ":random",
        "//src/main/java/com/google/crypto/tink/annotations:alpha",
        "//src/main/java/com/google/crypto/tink/internal:curve25519",
        "//src/main/java/com/google/crypto/tink/internal:field25519",
    ],
)

java_library(
    name = "ecies_hkdf_sender_kem",
    srcs = ["EciesHkdfSenderKem.java"],
    deps = [
        ":elliptic_curves",
        ":hkdf",
        "//src/main/java/com/google/crypto/tink/util:bytes",
    ],
)

java_library(
    name = "pem_key_type",
    srcs = ["PemKeyType.java"],
    deps = [
        ":base64",
        ":elliptic_curves",
        ":enums",
        ":subtle_util_cluster",
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "aes_gcm_hkdf_streaming",
    srcs = ["AesGcmHkdfStreaming.java"],
    deps = [
        ":hkdf",
        ":nonce_based_streaming_aead_cluster",
        ":random",
        ":stream_segment_decrypter",
        ":stream_segment_encrypter",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:streaming_aead",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_gcm_hkdf_streaming_key",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_gcm_hkdf_streaming_parameters",
    ],
)

java_library(
    name = "encrypt_then_authenticate",
    srcs = ["EncryptThenAuthenticate.java"],
    deps = [
        ":aes_ctr_jce_cipher",
        ":bytes",
        ":ind_cpa_cipher",
        ":prf_hmac_jce",
        ":prf_mac",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:mac",
        "//src/main/java/com/google/crypto/tink/aead:aes_ctr_hmac_aead_key",
        "//src/main/java/com/google/crypto/tink/internal:util",
    ],
)

java_library(
    name = "bytes",
    srcs = ["Bytes.java"],
)

java_library(
    name = "elliptic_curves",
    srcs = ["EllipticCurves.java"],
    deps = [
        ":subtle_util_cluster",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding",
        "//src/main/java/com/google/crypto/tink/internal:elliptic_curves_util",
    ],
)

java_library(
    name = "rsa_ssa_pkcs1_verify_jce",
    srcs = ["RsaSsaPkcs1VerifyJce.java"],
    deps = [
        ":bytes",
        ":enums",
        ":hex",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:public_key_verify",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_parameters",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pkcs1_verify_conscrypt",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "ecies_aead_hkdf_hybrid_encrypt",
    srcs = ["EciesAeadHkdfHybridEncrypt.java"],
    deps = [
        ":ecies_hkdf_sender_kem",
        ":elliptic_curves",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:hybrid_encrypt",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_parameters",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_public_key",
        "//src/main/java/com/google/crypto/tink/hybrid/internal:ecies_dem_helper",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter",
    ],
)

java_library(
    name = "ecdsa_sign_jce",
    srcs = ["EcdsaSignJce.java"],
    deps = [
        ":elliptic_curves",
        ":enums",
        "//src/main/java/com/google/crypto/tink:public_key_sign",
        "//src/main/java/com/google/crypto/tink/signature:ecdsa_private_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:ecdsa_sign_jce",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "validators",
    srcs = ["Validators.java"],
    deps = [
        ":enums",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
    ],
)

java_library(
    name = "selfkeytests_validators",
    srcs = ["SelfKeyTestValidators.java"],
    deps = [
        ":ecdsa_sign_jce",
        ":ecdsa_verify_jce",
        ":elliptic_curves",
        ":enums",
        ":rsa_ssa_pkcs1_sign_jce",
        ":rsa_ssa_pkcs1_verify_jce",
        ":rsa_ssa_pss_sign_jce",
        ":rsa_ssa_pss_verify_jce",
        "@maven//:com_google_protobuf_protobuf_java",
    ],
)

java_library(
    name = "stream_segment_encrypter",
    srcs = ["StreamSegmentEncrypter.java"],
)

java_library(
    name = "aes_siv",
    srcs = ["AesSiv.java"],
    deps = [
        ":bytes",
        ":prf_aes_cmac",
        ":subtle_util_cluster",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:deterministic_aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/daead:aes_siv_key",
        "//src/main/java/com/google/crypto/tink/daead/subtle:deterministic_aeads",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/mac/internal:aes_util",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters",
        "//src/main/java/com/google/crypto/tink/prf:prf_set",
        "//src/main/java/com/google/crypto/tink/util:bytes",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "ind_cpa_cipher",
    srcs = ["IndCpaCipher.java"],
)

java_library(
    name = "engine_wrapper",
    srcs = ["EngineWrapper.java"],
)

java_library(
    name = "prf_mac",
    srcs = ["PrfMac.java"],
    deps = [
        ":bytes",
        ":prf_aes_cmac",
        ":prf_hmac_jce",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:mac",
        "//src/main/java/com/google/crypto/tink/mac:aes_cmac_key",
        "//src/main/java/com/google/crypto/tink/mac:aes_cmac_parameters",
        "//src/main/java/com/google/crypto/tink/mac:hmac_key",
        "//src/main/java/com/google/crypto/tink/mac:hmac_parameters",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters",
        "//src/main/java/com/google/crypto/tink/prf:prf_set",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "rsa_ssa_pss_verify_jce",
    srcs = ["RsaSsaPssVerifyJce.java"],
    deps = [
        ":bytes",
        ":enums",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:public_key_verify",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_parameters",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pss_verify_conscrypt",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "random",
    srcs = ["Random.java"],
    deps = ["//src/main/java/com/google/crypto/tink/internal:random"],
)

java_library(
    name = "aes_gcm_jce",
    srcs = ["AesGcmJce.java"],
    deps = [
        ":random",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/aead:aes_gcm_key",
        "//src/main/java/com/google/crypto/tink/aead/internal:aes_gcm_jce_util",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/util:bytes",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "hex",
    srcs = ["Hex.java"],
)

java_library(
    name = "ed25519_sign",
    srcs = ["Ed25519Sign.java"],
    deps = [
        ":bytes",
        ":random",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:public_key_sign",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:ed25519_cluster",
        "//src/main/java/com/google/crypto/tink/internal:field25519",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_parameters",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_private_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:ed25519_sign_jce",
    ],
)

java_library(
    name = "ecies_hkdf_recipient_kem",
    srcs = ["EciesHkdfRecipientKem.java"],
    deps = [
        ":elliptic_curves",
        ":hkdf",
    ],
)

java_library(
    name = "enums",
    srcs = ["Enums.java"],
)

java_library(
    name = "aes_eax_jce",
    srcs = ["AesEaxJce.java"],
    deps = [
        ":prf_aes_cmac",
        ":random",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/aead:aes_eax_key",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters",
        "//src/main/java/com/google/crypto/tink/prf:prf_set",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes",
    ],
)

java_library(
    name = "ed25519_verify",
    srcs = ["Ed25519Verify.java"],
    deps = [
        ":bytes",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:public_key_verify",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:ed25519_cluster",
        "//src/main/java/com/google/crypto/tink/internal:field25519",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_parameters",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:ed25519_verify_jce",
        "//src/main/java/com/google/crypto/tink/util:bytes",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "x_cha_cha20",
    srcs = ["XChaCha20.java"],
    deps = [
        ":ind_cpa_cipher",
        ":random",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_x_cha_cha20",
    ],
)

java_library(
    name = "rsa_ssa_pkcs1_sign_jce",
    srcs = ["RsaSsaPkcs1SignJce.java"],
    deps = [
        ":enums",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:public_key_sign",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_parameters",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_private_key",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pkcs1_sign_jce",
        "//src/main/java/com/google/crypto/tink/util:secret_big_integer",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "cha_cha20",
    srcs = ["ChaCha20.java"],
    deps = [
        ":ind_cpa_cipher",
        ":random",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_cha_cha20",
    ],
)

java_library(
    name = "ecdsa_verify_jce",
    srcs = ["EcdsaVerifyJce.java"],
    deps = [
        ":elliptic_curves",
        ":enums",
        "//src/main/java/com/google/crypto/tink:public_key_verify",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/signature:ecdsa_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:ecdsa_verify_jce",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "rewindable_readable_byte_channel",
    srcs = ["RewindableReadableByteChannel.java"],
    deps = ["@maven//:com_google_code_findbugs_jsr305"],
)

java_library(
    name = "hkdf",
    srcs = ["Hkdf.java"],
    deps = [
        ":bytes",
        ":subtle_util_cluster",
    ],
)

java_library(
    name = "rsa_ssa_pss_sign_jce",
    srcs = ["RsaSsaPssSignJce.java"],
    deps = [
        ":bytes",
        ":enums",
        ":random",
        ":rsa_ssa_pss_verify_jce",
        ":subtle_util_cluster",
        ":validators",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink:public_key_sign",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_parameters",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_private_key",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_public_key",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pss_sign_conscrypt",
        "//src/main/java/com/google/crypto/tink/util:secret_big_integer",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "base64",
    srcs = ["Base64.java"],
    deps = ["@maven//:com_google_errorprone_error_prone_annotations"],
)

java_library(
    name = "prf_hmac_jce",
    srcs = ["PrfHmacJce.java"],
    deps = [
        ":subtle_util_cluster",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/prf:hmac_prf_key",
        "//src/main/java/com/google/crypto/tink/prf:prf_set",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "kwp",
    srcs = ["Kwp.java"],
    deps = [
        ":subtle_util_cluster",
        "//src/main/java/com/google/crypto/tink:key_wrap",
    ],
)

java_library(
    name = "x_cha_cha20_poly1305",
    srcs = ["XChaCha20Poly1305.java"],
    deps = [
        ":bytes",
        ":random",
        ":x_cha_cha20",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:aead",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/aead:x_cha_cha20_poly1305_key",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_x_cha_cha20_poly1305",
        "//src/main/java/com/google/crypto/tink/aead/internal:poly1305",
        "//src/main/java/com/google/crypto/tink/internal:util",
    ],
)

java_library(
    name = "ecies_aead_hkdf_hybrid_decrypt",
    srcs = ["EciesAeadHkdfHybridDecrypt.java"],
    deps = [
        ":ecies_aead_hkdf_hybrid_encrypt",
        ":ecies_hkdf_recipient_kem",
        ":elliptic_curves",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key",
        "//src/main/java/com/google/crypto/tink:hybrid_decrypt",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_private_key",
        "//src/main/java/com/google/crypto/tink/hybrid/internal:ecies_dem_helper",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding",
        "//src/main/java/com/google/crypto/tink/internal:util",
    ],
)

java_library(
    name = "nonce_based_streaming_aead_cluster",
    srcs = [
        "NonceBasedStreamingAead.java",
        "StreamingAeadDecryptingChannel.java",
        "StreamingAeadDecryptingStream.java",
        "StreamingAeadEncryptingChannel.java",
        "StreamingAeadEncryptingStream.java",
        "StreamingAeadSeekableDecryptingChannel.java",
    ],
    deps = [
        ":stream_segment_decrypter",
        ":stream_segment_encrypter",
        "//src/main/java/com/google/crypto/tink:streaming_aead",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "subtle_util_cluster",
    srcs = [
        "EngineFactory.java",
        "SubtleUtil.java",
    ],
    deps = [
        ":engine_wrapper",
        ":enums",
        ":validators",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding",
        "//src/main/java/com/google/crypto/tink/internal:util",
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "engine_wrapper-android",
    srcs = ["EngineWrapper.java"],
)

android_library(
    name = "aes_ctr_hmac_streaming-android",
    srcs = ["AesCtrHmacStreaming.java"],
    deps = [
        ":bytes-android",
        ":hkdf-android",
        ":nonce_based_streaming_aead_cluster-android",
        ":random-android",
        ":stream_segment_decrypter-android",
        ":stream_segment_encrypter-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:streaming_aead-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_ctr_hmac_streaming_key-android",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_ctr_hmac_streaming_parameters-android",
    ],
)

android_library(
    name = "aes_ctr_jce_cipher-android",
    srcs = ["AesCtrJceCipher.java"],
    deps = [
        ":ind_cpa_cipher-android",
        ":random-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
    ],
)

android_library(
    name = "aes_gcm_hkdf_streaming-android",
    srcs = ["AesGcmHkdfStreaming.java"],
    deps = [
        ":hkdf-android",
        ":nonce_based_streaming_aead_cluster-android",
        ":random-android",
        ":stream_segment_decrypter-android",
        ":stream_segment_encrypter-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:streaming_aead-android",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_gcm_hkdf_streaming_key-android",
        "//src/main/java/com/google/crypto/tink/streamingaead:aes_gcm_hkdf_streaming_parameters-android",
    ],
)

android_library(
    name = "aes_gcm_jce-android",
    srcs = ["AesGcmJce.java"],
    deps = [
        ":random-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/aead:aes_gcm_key-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:aes_gcm_jce_util-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/util:bytes-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "aes_siv-android",
    srcs = ["AesSiv.java"],
    deps = [
        ":bytes-android",
        ":prf_aes_cmac-android",
        ":subtle_util_cluster-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:deterministic_aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/daead:aes_siv_key-android",
        "//src/main/java/com/google/crypto/tink/daead/subtle:deterministic_aeads-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/mac/internal:aes_util-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters-android",
        "//src/main/java/com/google/crypto/tink/prf:prf_set-android",
        "//src/main/java/com/google/crypto/tink/util:bytes-android",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "base64-android",
    srcs = ["Base64.java"],
    deps = ["@maven//:com_google_errorprone_error_prone_annotations"],
)

android_library(
    name = "bytes-android",
    srcs = ["Bytes.java"],
)

android_library(
    name = "cha_cha20-android",
    srcs = ["ChaCha20.java"],
    deps = [
        ":ind_cpa_cipher-android",
        ":random-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_cha_cha20-android",
    ],
)

android_library(
    name = "cha_cha20_poly1305-android",
    srcs = ["ChaCha20Poly1305.java"],
    deps = [
        ":bytes-android",
        ":cha_cha20-android",
        ":random-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/aead:cha_cha20_poly1305_key-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_cha_cha20_poly1305-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:poly1305-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
    ],
)

android_library(
    name = "ecdsa_sign_jce-android",
    srcs = ["EcdsaSignJce.java"],
    deps = [
        ":elliptic_curves-android",
        ":enums-android",
        "//src/main/java/com/google/crypto/tink:public_key_sign-android",
        "//src/main/java/com/google/crypto/tink/signature:ecdsa_private_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:ecdsa_sign_jce-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "ecdsa_verify_jce-android",
    srcs = ["EcdsaVerifyJce.java"],
    deps = [
        ":elliptic_curves-android",
        ":enums-android",
        "//src/main/java/com/google/crypto/tink:public_key_verify-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/signature:ecdsa_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:ecdsa_verify_jce-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "ecies_aead_hkdf_hybrid_decrypt-android",
    srcs = ["EciesAeadHkdfHybridDecrypt.java"],
    deps = [
        ":ecies_aead_hkdf_hybrid_encrypt-android",
        ":ecies_hkdf_recipient_kem-android",
        ":elliptic_curves-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:hybrid_decrypt-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_private_key-android",
        "//src/main/java/com/google/crypto/tink/hybrid/internal:ecies_dem_helper-android",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
    ],
)

android_library(
    name = "ecies_aead_hkdf_hybrid_encrypt-android",
    srcs = ["EciesAeadHkdfHybridEncrypt.java"],
    deps = [
        ":ecies_hkdf_sender_kem-android",
        ":elliptic_curves-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:hybrid_encrypt-android",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_parameters-android",
        "//src/main/java/com/google/crypto/tink/hybrid:ecies_public_key-android",
        "//src/main/java/com/google/crypto/tink/hybrid/internal:ecies_dem_helper-android",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter-android",
    ],
)

android_library(
    name = "ecies_hkdf_recipient_kem-android",
    srcs = ["EciesHkdfRecipientKem.java"],
    deps = [
        ":elliptic_curves-android",
        ":hkdf-android",
    ],
)

android_library(
    name = "ecies_hkdf_sender_kem-android",
    srcs = ["EciesHkdfSenderKem.java"],
    deps = [
        ":elliptic_curves-android",
        ":hkdf-android",
        "//src/main/java/com/google/crypto/tink/util:bytes-android",
    ],
)

android_library(
    name = "ed25519_sign-android",
    srcs = ["Ed25519Sign.java"],
    deps = [
        ":bytes-android",
        ":random-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:public_key_sign-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:ed25519_cluster-android",
        "//src/main/java/com/google/crypto/tink/internal:field25519-android",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_private_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:ed25519_sign_jce-android",
    ],
)

android_library(
    name = "aes_eax_jce-android",
    srcs = ["AesEaxJce.java"],
    deps = [
        ":prf_aes_cmac-android",
        ":random-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/aead:aes_eax_key-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters-android",
        "//src/main/java/com/google/crypto/tink/prf:prf_set-android",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes-android",
    ],
)

android_library(
    name = "ed25519_verify-android",
    srcs = ["Ed25519Verify.java"],
    deps = [
        ":bytes-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:public_key_verify-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:ed25519_cluster-android",
        "//src/main/java/com/google/crypto/tink/internal:field25519-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:ed25519_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:ed25519_verify_jce-android",
        "//src/main/java/com/google/crypto/tink/util:bytes-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "elliptic_curves-android",
    srcs = ["EllipticCurves.java"],
    deps = [
        ":subtle_util_cluster-android",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding-android",
        "//src/main/java/com/google/crypto/tink/internal:elliptic_curves_util-android",
    ],
)

android_library(
    name = "encrypt_then_authenticate-android",
    srcs = ["EncryptThenAuthenticate.java"],
    deps = [
        ":aes_ctr_jce_cipher-android",
        ":bytes-android",
        ":ind_cpa_cipher-android",
        ":prf_hmac_jce-android",
        ":prf_mac-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:mac-android",
        "//src/main/java/com/google/crypto/tink/aead:aes_ctr_hmac_aead_key-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
    ],
)

android_library(
    name = "enums-android",
    srcs = ["Enums.java"],
)

android_library(
    name = "hex-android",
    srcs = ["Hex.java"],
)

android_library(
    name = "hkdf-android",
    srcs = ["Hkdf.java"],
    deps = [
        ":bytes-android",
        ":subtle_util_cluster-android",
    ],
)

android_library(
    name = "ind_cpa_cipher-android",
    srcs = ["IndCpaCipher.java"],
)

android_library(
    name = "kwp-android",
    srcs = ["Kwp.java"],
    deps = [
        ":subtle_util_cluster-android",
        "//src/main/java/com/google/crypto/tink:key_wrap-android",
    ],
)

android_library(
    name = "nonce_based_streaming_aead_cluster-android",
    srcs = [
        "NonceBasedStreamingAead.java",
        "StreamingAeadDecryptingChannel.java",
        "StreamingAeadDecryptingStream.java",
        "StreamingAeadEncryptingChannel.java",
        "StreamingAeadEncryptingStream.java",
        "StreamingAeadSeekableDecryptingChannel.java",
    ],
    deps = [
        ":stream_segment_decrypter-android",
        ":stream_segment_encrypter-android",
        "//src/main/java/com/google/crypto/tink:streaming_aead-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "pem_key_type-android",
    srcs = ["PemKeyType.java"],
    deps = [
        ":base64-android",
        ":elliptic_curves-android",
        ":enums-android",
        ":subtle_util_cluster-android",
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "prf_aes_cmac-android",
    srcs = ["PrfAesCmac.java"],
    deps = [
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters-android",
        "//src/main/java/com/google/crypto/tink/prf:prf_set-android",
        "//src/main/java/com/google/crypto/tink/prf/internal:prf_aes_cmac-android",
        "//src/main/java/com/google/crypto/tink/prf/internal:prf_aes_cmac_conscrypt-android",
        "//src/main/java/com/google/crypto/tink/util:secret_bytes-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "prf_hmac_jce-android",
    srcs = ["PrfHmacJce.java"],
    deps = [
        ":subtle_util_cluster-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/prf:hmac_prf_key-android",
        "//src/main/java/com/google/crypto/tink/prf:prf_set-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "prf_mac-android",
    srcs = ["PrfMac.java"],
    deps = [
        ":bytes-android",
        ":prf_aes_cmac-android",
        ":prf_hmac_jce-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:mac-android",
        "//src/main/java/com/google/crypto/tink/mac:aes_cmac_key-android",
        "//src/main/java/com/google/crypto/tink/mac:aes_cmac_parameters-android",
        "//src/main/java/com/google/crypto/tink/mac:hmac_key-android",
        "//src/main/java/com/google/crypto/tink/mac:hmac_parameters-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_key-android",
        "//src/main/java/com/google/crypto/tink/prf:aes_cmac_prf_parameters-android",
        "//src/main/java/com/google/crypto/tink/prf:prf_set-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "random-android",
    srcs = ["Random.java"],
    deps = ["//src/main/java/com/google/crypto/tink/internal:random-android"],
)

android_library(
    name = "rewindable_readable_byte_channel-android",
    srcs = ["RewindableReadableByteChannel.java"],
    deps = ["@maven//:com_google_code_findbugs_jsr305"],
)

android_library(
    name = "rsa_ssa_pkcs1_sign_jce-android",
    srcs = ["RsaSsaPkcs1SignJce.java"],
    deps = [
        ":enums-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:public_key_sign-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_private_key-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pkcs1_sign_jce-android",
        "//src/main/java/com/google/crypto/tink/util:secret_big_integer-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "rsa_ssa_pkcs1_verify_jce-android",
    srcs = ["RsaSsaPkcs1VerifyJce.java"],
    deps = [
        ":bytes-android",
        ":enums-android",
        ":hex-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:public_key_verify-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pkcs1_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pkcs1_verify_conscrypt-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "rsa_ssa_pss_sign_jce-android",
    srcs = ["RsaSsaPssSignJce.java"],
    deps = [
        ":bytes-android",
        ":enums-android",
        ":random-android",
        ":rsa_ssa_pss_verify_jce-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink:public_key_sign-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_private_key-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pss_sign_conscrypt-android",
        "//src/main/java/com/google/crypto/tink/util:secret_big_integer-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "rsa_ssa_pss_verify_jce-android",
    srcs = ["RsaSsaPssVerifyJce.java"],
    deps = [
        ":bytes-android",
        ":enums-android",
        ":subtle_util_cluster-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:public_key_verify-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:enum_type_proto_converter-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_parameters-android",
        "//src/main/java/com/google/crypto/tink/signature:rsa_ssa_pss_public_key-android",
        "//src/main/java/com/google/crypto/tink/signature/internal:rsa_ssa_pss_verify_conscrypt-android",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "selfkeytests_validators-android",
    srcs = ["SelfKeyTestValidators.java"],
    deps = [
        ":ecdsa_sign_jce-android",
        ":ecdsa_verify_jce-android",
        ":elliptic_curves-android",
        ":enums-android",
        ":rsa_ssa_pkcs1_sign_jce-android",
        ":rsa_ssa_pkcs1_verify_jce-android",
        ":rsa_ssa_pss_sign_jce-android",
        ":rsa_ssa_pss_verify_jce-android",
        "@maven//:com_google_protobuf_protobuf_javalite",
    ],
)

android_library(
    name = "stream_segment_decrypter-android",
    srcs = ["StreamSegmentDecrypter.java"],
)

android_library(
    name = "stream_segment_encrypter-android",
    srcs = ["StreamSegmentEncrypter.java"],
)

android_library(
    name = "subtle_util_cluster-android",
    srcs = [
        "EngineFactory.java",
        "SubtleUtil.java",
    ],
    deps = [
        ":engine_wrapper-android",
        ":enums-android",
        ":validators-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
        "//src/main/java/com/google/crypto/tink/internal:big_integer_encoding-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

android_library(
    name = "validators-android",
    srcs = ["Validators.java"],
    deps = [
        ":enums-android",
        "//src/main/java/com/google/crypto/tink/config/internal:tink_fips_util-android",
    ],
)

android_library(
    name = "x25519-android",
    srcs = ["X25519.java"],
    deps = [
        ":random-android",
        "//src/main/java/com/google/crypto/tink/annotations:alpha-android",
        "//src/main/java/com/google/crypto/tink/internal:curve25519-android",
        "//src/main/java/com/google/crypto/tink/internal:field25519-android",
    ],
)

android_library(
    name = "x_cha_cha20-android",
    srcs = ["XChaCha20.java"],
    deps = [
        ":ind_cpa_cipher-android",
        ":random-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_x_cha_cha20-android",
    ],
)

android_library(
    name = "x_cha_cha20_poly1305-android",
    srcs = ["XChaCha20Poly1305.java"],
    deps = [
        ":bytes-android",
        ":random-android",
        ":x_cha_cha20-android",
        "//src/main/java/com/google/crypto/tink:accesses_partial_key-android",
        "//src/main/java/com/google/crypto/tink:aead-android",
        "//src/main/java/com/google/crypto/tink:insecure_secret_key_access-android",
        "//src/main/java/com/google/crypto/tink/aead:x_cha_cha20_poly1305_key-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:insecure_nonce_x_cha_cha20_poly1305-android",
        "//src/main/java/com/google/crypto/tink/aead/internal:poly1305-android",
        "//src/main/java/com/google/crypto/tink/internal:util-android",
    ],
)
